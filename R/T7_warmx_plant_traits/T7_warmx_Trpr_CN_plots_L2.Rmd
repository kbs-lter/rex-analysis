---
title: "T7 warmx Trpr CN 2022 Plots"
author: "Moriah Young"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

COLLABORATORS: Adrian Noecker, Phoebe Zarnetske, Mark Hammond
DATA INPUT:  csv from the shared Google drive  
DATA OUTPUT: Code and Rmd are in the scripts folder in Github  
PROJECT: REX


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Clear all existing data
rm(list=ls())

# Load packages
library(tidyverse)
library(plotrix)
library(rstatix)
library(car)

# Set working directory from .Renviron
dir <- Sys.getenv("DATA_DIR")
list.files(dir)

# Read in data
trpr_cn <- read.csv(file.path(dir, "T7_warmx_plant_traits/L1/T7_warmx_CN_Trpr_2022_L1.csv")) # 2022 CN Trpr data

#making order for graph
level_order_1 <- c('irrigated_control', 'ambient', 'drought', 'warmed','warmed_drought')

```

Carbon
```{r}
# Average by cn weighsheet replicate
carbon_rep_avg <- trpr_cn %>%
  group_by(Unique_ID, Species_Code, Subplot_Descriptions) %>%
  summarize(avg_rep_carbon = mean(Carbon, na.rm = TRUE),
            se = std.error(Carbon, na.rm = TRUE))

carbon_treatment_avg <- trpr_cn %>%
  group_by(Species_Code, Subplot_Descriptions) %>%
  summarize(avg_carbon = mean(Carbon, na.rm = TRUE),
            se = std.error(Carbon, na.rm = TRUE))
```

Nitrogen
```{r}
# Average by cn weighsheet replicate
nitrogen_rep_avg <- trpr_cn %>%
  group_by(Unique_ID, Species_Code, Subplot_Descriptions) %>%
  summarize(avg_rep_nitrogen = mean(Nitrogen, na.rm = TRUE),
            se = std.error(Nitrogen, na.rm = TRUE))

nitrogen_treatment_avg <- trpr_cn %>%
  group_by(Species_Code, Subplot_Descriptions) %>%
  summarize(avg_nitrogen = mean(Nitrogen, na.rm = TRUE),
            se = std.error(Nitrogen, na.rm = TRUE))
```

Box Plots
```{r}
# Carbon
png("T7_warmx_Trpr_Carbon_2022.png", units="in", width=8, height=6, res=300)
ggplot(carbon_rep_avg, aes(x = factor(Subplot_Descriptions, levels = level_order_1), y = avg_rep_carbon, fill = Subplot_Descriptions)) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = Subplot_Descriptions)) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        facet_wrap(~Species_Code, scales = "free_x") +
        scale_fill_manual(values = c("ambient" = "darkblue", "drought" = "gray58", 
        "irrigated_control" = "deepskyblue", "warmed" = "red2", "warmed_drought" = "darkred")) +
        labs(x = "Treatment", y = "2022 Red Clover Carbon (%)") +
        scale_x_discrete(labels=c("ambient" = "Ambient",
                                  "drought" = "Drought",
                                  "irrigated_control" = "Irrigated \n Control",
                                  "warmed" = "Warmed",
                                  "warmed_drought" = "Warmed +\n Drought")) +
        theme(legend.position = "none")
dev.off()

# Nitrogen
png("T7_warmx_Trpr_Nitrogen_2022.png", units="in", width=8, height=6, res=300)
ggplot(nitrogen_rep_avg, aes(x = factor(Subplot_Descriptions, levels = level_order_1), y = avg_rep_nitrogen, fill = Subplot_Descriptions)) +
        geom_jitter(shape=16, position=position_jitterdodge(), alpha = 0.6, aes(colour = Subplot_Descriptions)) +
        geom_boxplot(color = "black", outlier.shape = NA) +
        facet_wrap(~Species_Code, scales = "free_x") +
        scale_fill_manual(values = c("ambient" = "darkblue", "drought" = "gray58", 
        "irrigated_control" = "deepskyblue", "warmed" = "red2", "warmed_drought" = "darkred")) +
        labs(x = "Treatment", y = "2022 Red Clover Nitrogen (%)") +
        scale_x_discrete(labels=c("ambient" = "Ambient",
                                  "drought" = "Drought",
                                  "irrigated_control" = "Irrigated \n Control",
                                  "warmed" = "Warmed",
                                  "warmed_drought" = "Warmed +\n Drought")) +
        theme(legend.position = "none")
dev.off()
```

